---
title: "Overfitting the Data: Compact Neural Video Delivery via Content-aware Feature Modulation"
subtitle: "过拟合超分 CaFM"
layout: post
author: "L Hondong"
header-img: "img/post-bg-9.jpg"
mathjax: true
tags:
  - 视频超分
  - 过拟合
---

# 过拟合超分 CaFM

Overfitting the Data: Compact Neural Video Delivery via Content-aware Feature Modulation

北邮，Intel 中国

## 摘要

将视频划分为块，并将 LR 视频块和相应的内容感知模型传输到客户端。客户端超分 LR 块。因此大量模型需要传输。

首先仔细研究了不同块的模型之间的关系，然后设计了一个联合训练框架以及内容感知特征调制 CaFM 层来压缩这些模型。

每个视频块仅需要原始参数量的 1%，还实现了更好的超分性能。

初步实验表明，在相同的存储下，比 H.264 和 H.265 的视频质量更好。

## 一、简介

### 1.1 Motivation

<div align=center><img src="/images/CaFM-2022-01-12-12-27-20.png" alt="CaFM-2022-01-12-12-27-20" style="zoom:50%;" /></div>

### 1.2 Contributions

## 二、相关工作

### 2.1 Neural Video Delivery

Yeo，2018 年提出 Neural adaptive content-aware internet video delivery（NAS），能够解决带宽受限时视频质量变差的问题。video quality degradation problem when bandwidth becomes congested。NAS 在相同的贷款在能够提高 QoE 43.08%，在相同的 QoE 下能够节省 17.13% 的带宽。

NAS 的核心思想是利用 DNN 的过拟合特性，提高训练精度使性能增强。

NAS 已用于 UAV video streaming，Live Streaming，360 Video Streaming，Volumetric Video Streaming 和 Mobile Video Streaming。

## 三、方法

NAS 方法使用 LR 视频和内容感知模型取代传统视频传输中的 HR 视频。整个过程分为三步：

1. 在服务器上为视频块训练模型；
2. 传输 LR 块和内容感知模型到客户端；
3. 在客户端超分。

将视频分为 n 个块，训练 n 个 EDSR 模型，其 feature maps 如图。

<div align=center><img src="/images/CaFM-2022-01-12-12-27-49.png" alt="CaFM-2022-01-12-12-27-49" style="zoom:50%;" /></div>

计算余弦距离发现，虽然用不同的视频块训练不同的模型，但是 $f_{1,j,k}$ 和 $f_{2,j,k}$ 之间的关系近似线性的。**因此可以共享大部分参数**。然后使用 CaFM 使每个 DNN 专有化。

然而，这样需要为每个视频块传输一个模型，额外的带宽消耗。所以引入 CaFM 模块，但是对每个视频块微调 CaFM 模块效果并不好。

### 3.1 Content-aware Feature Modulation

<div align=center><img src="/images/CaFM-2022-01-12-12-28-23.png" alt="CaFM-2022-01-12-12-28-23" style="zoom:50%;" /></div>

将 CaFM 表示为通道线性函数：

$$
CaFM(x_j)=a_j*x_j+b_j,0<j<C
$$

使用 CaFM 来调整 baseline 模型每个滤波器的输出特征。以 EDSR 为例，CaFM 的参数约占 EDSR 的 0.6%。因此，一个有 n 个块的视频，可以将模型的大小从 n 个 EDSR 减少到 1 个共享 EDSR 加上 n 个专用的 CaFM。

### 3.2 联合训练框架

与单独训练的模型相比，对每个专有的 CaFM 模块进行微调效果并不好，所以设计了一个联合训练框架，同时训练所有的模型，$I_{SR}^{i,s}=g(I_{LR}^{i,s},W_s,W_i)$，其中 $W_s$ 代表共享的参数，$W_i$ 代表第 i 个视频块专有的 CaFM 参数。

## 四、实验

因为 CaFM 可以应用于不同的 SR，所以用不同的 SR 网络做了大量的实验，（EDSR、VDSR、ESPCN 和 SRCNN）。

这里以 EDSR 为例，将 CaFM 模块加到 EDSR 中每个卷积层的输出后，其中 CaFM 为 1×1 depth-wise 卷积，EDSR 可以相应的修改为不同的 SR 网络。

- External learning：

EDSR 和 EDVR 等，在大规模数据集上训练，并使用训练后的 DNN 超分 LR 输入帧。叫外部学习。

- Content-aware learning：

对于 neural video delivery，视频提前就知道了，所以可以训练一个过拟合模型，每个视频匹配一个模型，从而使 SR 性能更好。

<div align=center><img src="/images/CaFM-2022-01-12-12-28-49.png" alt="CaFM-2022-01-12-12-28-49" style="zoom:50%;" /></div>

### 数据集

由于 Vimeo-90K 和 REDS 仅由相邻帧序列组成，不适用于视频传输。

### 实验结果

与 H.264 和 H.265 对比结果：

<div align=center><img src="/images/CaFM-2022-01-12-12-29-09.png" alt="CaFM-2022-01-12-12-29-09" style="zoom:50%;" /></div>

## 五、总结
