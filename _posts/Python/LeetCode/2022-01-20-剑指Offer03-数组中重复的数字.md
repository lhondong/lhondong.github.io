---
title: "剑指 Offer 03. 数组中重复的数字"
subtitle: "LeetCode 刷题笔记"
layout: post
author: "L Hondong"
header-img: "img/post-bg-12.jpg"
mathjax: ture
tags:
  - LeetCode
  - 算法
---

# 剑指 Offer 03. 数组中重复的数字

## 题目

找出数组中重复的数字。


在一个长度为 n 的数组 nums 里的所有数字都在 0～n-1 的范围内。数组中某些数字是重复的，但不知道有几个数字重复了，也不知道每个数字重复了几次。请找出数组中任意一个重复的数字。

## 示例

示例 1:

```
输入：
[2, 3, 1, 0, 2, 5, 3]
输出：2 或 3 
```

## 题解

### 常规哈希表

```python
class Solution(object):
    def findRepeatNumber(self, nums):
        """
        :type nums: List[int]
        :rtype: int
        """
        hashtable = set()
        for i in nums:
            if i in hashtable:
                return i
            hashtable.add(i)
```
用 set() 可以直接 .add() 添加，方便。

### 原地交换

在一个长度为 n 的数组 nums 里的所有数字都在 0 ~ n-1 的范围内。此说明含义：数组元素的**索引**和**值**是**一对多**的关系。

n 个数，0～n-1，说明如果不是 1,2,3,4,5...，那么一定存在相同的数。

因此，可遍历数组并通过交换操作，使元素的**索引**与**值**一一对应（即 nums[i]=i ）。因而，就能通过索引映射对应的值，起到与字典等价的作用。

<div align=center><img src="/images/剑指Offer03-数组中重复的数字-2022-01-20-22-43-43.png" alt="剑指Offer03-数组中重复的数字-2022-01-20-22-43-43" style="zoom:50%;" /></div>

遍历中，第一次遇到数字 x 时，将其交换至索引 x 处；而当第二次遇到数字 x 时，一定有 nums[x]=x ，此时即可得到一组重复数字。

<div align=center><img src="/images/剑指Offer03-数组中重复的数字-2022-01-20-23-00-56.png" alt="剑指Offer03-数组中重复的数字-2022-01-20-23-00-56" style="zoom:50%;" /></div>

#### 算法流程：

1. 遍历数组 nums ，设索引初始值为 i=0:
   - 若 nums[i]=i： 说明此数字已在对应索引位置，无需交换，因此跳过；
   - 若 nums[nums[i]]=nums[i]：代表索引 nums[i] 处和索引 i 处的元素值都为 nums[i] ，即找到一组重复值，返回此值 nums[i]；
   - 否则： 交换索引为 i 和 nums[i] 的元素值，将此数字交换至对应索引位置。
若遍历完毕尚未返回，则返回 −1 。

### 复杂度分析：

- 时间复杂度 O(N)
- 空间复杂度 O(1)

错误：

```python
class Solution(object):
    def findRepeatNumber(self, nums):
        """
        :type nums: List[int]
        :rtype: int
        """
        for i in range(len(nums)):
            if nums[i] == i: i += 1
            elif nums[nums[i]] == nums[i]: return nums[i]
            else: nums[nums[i]], nums[i] = nums[i], nums[nums[i]]
        return -1
```

交换 i，nums[i] 元素的时候，i 的值更新了还需要在下一次遍历中判断，此时 i 指针不动，只有当值在“正确”位置 nums[i] == i 时，才将i右移一位，这样保证找到相同元素前不会漏掉某些元素的处理，用 for 循环写很容易出错！！

比如 [3,4,2,0,0,1]，如果 nums[0] 不等于 0 时 i就前进，会导致无法识别 0 的重复。

正确：

```python
class Solution(object):
    def findRepeatNumber(self, nums):
        """
        :type nums: List[int]
        :rtype: int
        """
        i = 0
        while i < len(nums):
            if nums[i] == i: 
                i += 1
                continue
            if nums[nums[i]] == nums[i]: return nums[i]
            nums[nums[i]], nums[i] = nums[i], nums[nums[i]]
        return -1
```

关于 nums[nums[i]], nums[i] = nums[i], nums[nums[i]]，为什么这里的交换可以让元素的**索引**与**值**相等。

记 `num[i] = a，num[num[i]] = num[a] = b`,那么交换后，`num[i] = b`, `num[num[i]] = num[a]= a`，这时候下标 a 对应的元素也是a，达到目的。

Python 中， a, b = c, d 操作的原理是先暂存元组 (c, d) ，然后 “按左右顺序” 赋值给 a 和 b ，可省略暂存操作。