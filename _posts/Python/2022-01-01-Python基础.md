---
title: "Python"
subtitle: "Python 基础"
layout: post
author: "L Hondong"
header-img: "img/post-bg-2.jpg"
tags:
  - Python
---

# Python

## 绪论

高级语言：

- 按执行方式分为：
  - 编译型
  - 解释型
- 按类型声明分为：
  - 静态语言
  - 动态语言

Python 属于**解释型**，**动态语言**，所以速度比较慢。

Python 优点：

1. 方便灵活，简单易用
2. 生态丰富

因而可以提升开发速度，牺牲运行速度；专注于问题本身。

- 物理硬件性能显著提升，语言带来的性能影响趋向于减小
- 性能扩展，性能瓶颈用 C/C++ 等来实现，暴露 Python 借口

### 总结

- Python 速度慢，但适合写上层逻辑；
- C/C++ 速度快，适合底层写算法。
- 各区所长，有机融合。

### Python 发展简史

- 1989 年，荷兰程序员 Guido 为了打发无聊的圣诞节，决心开发一个新的脚本解释程序——Python。
- 1991 年，可用版本问世
- 2000 年，2.0 版本发布
- 2008 年，3.0 版本发布，**自我革命**
- 2010 年，2.X 版本发布最后一个版本 
- 2016 年，几乎所有重要的库完成升级
- 3.X 版本仍在不断的迭代更新中

## 一、基本语法元素

### 1. 数据类型

- 数字
  - int
  - float
  - complex 复数 3+4j（虚部为 1，必须写出 1j）
- 字符串 str
- 布尔类型 bool
- 列表
- 元组（不可变的列表）
- 字典
- 集合（无序的、元素互不相等）

### 2. 变量

变量的命名：

1. 首字符不允许为数字
2. 变量名中间不能有空格
3. 不能与 33 个 Python 保留字相同

```python
import keyword
 
keyList = keyword.kwlist
print(keyList)
 
>>> ['False', 'None', 'True', 'and', 'as', 'assert', 'async', 'await', 'break', 
    'class', 'continue', 'def', 'del', 'elif', 'else', 'except', 'finally',
     'for', 'from', 'global', 'if', 'import', 'in', 'is', 'lambda', 'nonlocal',
     'not', 'or', 'pass', 'raise', 'return', 'try', 'while', 'with', 'yield']
```

命名技巧：

1. 变量名尽可能具有实际意义，表明数据的某种特性
2. 变量名有多个单词组成，用下花线 _ 连接多个单词
3. 驼峰体：多个单词组成，单词首字母大写（类名）
4. 常量所有字母均大写

#### 变量的赋值

1. 一般赋值
   - 通过等号自右向左进行赋值
2. 增量赋值
   - `x += 10`
3. 打包赋值
   - `x, y = y, x`
   - 不需要第三个中间变量

### 3. 控制流程

- 顺序语句
- 循环语句 for
  - `for 元素 in 可迭代对象：执行语句`
- 循环语句 while 
  - `while 判断条件：条件为真，执行语句；条件为假，while 循环结束`
- 分支语句 if

### 4. 输入和输出

- 动态交互输入 input
  - `x = input("请输入一个数字：")`
- eval() 去掉引号
  - `x = eval(input("请输入一个数字："))`

- print 默认换行
  - 换行控制 end=
  - `print(123, end=" ")`
- 格式化输出方法 format

基本格式：`"字符{0: 修饰}字符{1}字符".format(value0, value1)`

严格按照下列顺序：

- `:` 引导符号
- <填充> 用于填充的字符 如 `*` `_` 等
- <对齐> 
  - `<` 左对齐 
  - `>` 右对齐 
  - `^` 居中对齐
- <宽度> 设定输出的宽度
- <，> 数字千分位分隔符，适用于整数和浮点数
- <. 精度> 浮点数：小数部分精度；字符串：最大输出长度
- <类型> 整数类型：b,c,d,o,x,X；浮点类型：e,E,f,%

#### 填充输出

```python
print("{0:_^20}".format(PI)) # : 表示修饰输出，_ 表示用下划线填充，^ 表示数字在中间，20 表示总长度为 20
>>> ____3.1415926_____ 

print("{0:*<30}".format(PI)) # * 表示用 * 填充，< 表示数字居左对齐，30 表示总长度为 30
>>> 3.1415926*********************

print("{0:^20}".format(PI)) # 不指定则默认是用空格填充
>>>      3.1415926      
```

#### 数字千分位分隔符

```python
print("{0:,}".format(10000000)) 
>>> 10,000,000

print("{0:&>20,}".format(10000000)) 
>>> &&&&&&&&&&10,000,000
```

**注意：必须先填充，再写数字千分位分隔符！**

#### 浮点数简化输出

```python
print("{0:.2f}".format(PI)) # 保留 2 位小数

print("{0:.1%}".format(0.818727)) # 按百分数输出
>>> 81.9%

print("{0:.2e}".format(0.818727)) # 科学计数法输出
>>> 8.19e+05
```

#### 整数的进制转换输出

```python
print("二进制{0:b},Unicode 码{0:c}, 十进制{0:d}, 八进制{0:o}, 十六进制{0:x}".format(450))

>>> 二进制 111000010,Unicode 码ǂ, 十进制 450, 八进制 702, 十六进制 1c2
```

此外可以使用大括号 {} 来转义大括号

```python
print ("{} 对应的位置是 {{0}}".format("Python"))

>>> Python 对应的位置是 {0}
```

### 5. 程序格式

1. 行最大长度
   - 所有行限制的最大字符数为 79
2. 缩进
   - 用缩进来**表示语句间的逻辑**
   - 在 for while if def class 等 **: 之后下一行开始进行缩进**，表明**后续代码与前句之间的从属关系**
   - 缩进量：4 字符
3. 使用空格
   - 二元运算符两边加一个空格
   - 使用不同优先级的运算符，考虑在最低优先级的运算符周围添加空格 `x = x*2 - 1` `c = (a+b) * (a-b)`
   - 在逗号后使用空格
   - 不要使用一个以上的空格
   - 在制定关键字参数或者默认参数值的时候，不要在=附近加上空格 `def fun(n=1, m=2):`

## 二、基本数据类型

### 数字类型

- 十进制与其他进制的转换

```python
a = bin(16)   # 转二进制
b = oct(16)   # 转八进制
c = hex(16)   # 转十六进制

>>> 0b10000 
    0o20 
    0x10
# 转换出来的是 str！！！
```

- 其他进制转十进制

```python
d = int(a, 2)      # 二进制转十进制
e = int(b, 8)      # 八进制转十进制
f = int(c, 16)     # 十六进制转十进制
```

#### 加减乘除

- 除法运算的结果是浮点数！！！

#### 浮点数：不确定性

**计算机采用二进制小数来表示浮点数的小数部分**，部分小数不能用二进制小数完全表示。

- 通常情况下不会影响计算精度 `0.1 + 0.7 输出 0.7999999999999999`
- 四舍五入获得精确解

```python
a = 3 * 0.1
>>> 0.30000000000000004

a == 0.3
>>> False

b = round(a, 1)
>>> 0.3

b == 0.3
>>> True
```

### 数字运算操作函数

#### 求绝对值 abs()

```python
abs(3+4j)  # 对复数 a+bj 执行的是求模运算 (a^2+b^2)^0.5
>>> 5.0
```

#### 幂次方 pow(x,n)

```python
pow(2, 5)  # pow(x,n) x 的 n 次方  等价于 x**n
>>> 32

pow(2, 5, 3) # 2^5 % 3  更快速
>>> 2
```

#### 四舍五入 round(x,n)

```python
a = 1.618
print(round(a))      # 默认四舍五入为整数
>>> 2

print(round(a, 2))   # 参数 2 表示四舍五入后保留 2 位小数
>>> 1.62

print(round(a, 5))   # 位数不足，无需补齐
>>> 1.618
```

#### 整数商和模运算 divmod(x,y)

-  等价于返回二元元组 `(x//y,x % y)`

```python
divmod(13, 5)   # 较（x//y,x % y）更快，只执行了一次 x/y
>>> (2, 3)
```

#### 序列最大/最小值 max( ) min( )

- 可以是几个数字，也可以是一个序列
- 求和函数 sum() 只能是序列

```python
max(3, 2, 3, 6, 9, 4, 5)
>>> 9

a = [3, 2, 3, 6, 9, 4, 5]
print("max:", max(a))
print("min:", min(a))
>>> max: 9
    min: 2

sum((1, 2, 3, 4, 5))
>>> 15

sum(1, 2, 3, 4, 5)
>>> TypeError: sum() takes at most 2 arguments (5 given)
```

#### 借助科学计算库 math/scipy/numpy

```python
import math   # 导入库
print(math.exp(1))   # 指数运算 e^x
print(math.log2(2))  # 对数运算
print(math.sqrt(4))  # 开平方运算  等价于 4^0.5

>>> 2.718281828459045
    1.0
    2.0

import numpy as np
a = [1, 2, 3, 4, 5]
print(np.mean(a))    # 求均值
print(np.median(a))  # 求中位数
print(np.std(a))     # 求标准差

>>> 3.0
    3.0
    1.4142135623730951
```

### 字符串类型

**转义符可以用来换行继续输入**

```python
s = "py\
thon"                    
print(s)

>>> python
```

#### 字符串的切片

**变量名 [开始位置：结束位置：切片间隔]**

- 切片间隔如不设置默认为 1，可省略
- 切片范围不包含结束位置（前闭后开）
- 起始位置是 0，可以省略
- 结束位置省略，代表可以取到最后一个字符
- 可以使用反向索引

```python
s = "Python"
print(s[0:6])
print(s[:6])
print(s[:])
print(s[-6:])

>>> Python
```

**反向切片**

- 起始位置是 -1，也可以省略
- 结束位置省略，代表可以取到第一个字符

```python
s = "123456789"
print(s[-1:-10:-1])
print(s[:-10:-1]) # 开始位置缺省，默认为-1
print(s[::-1])  # 获得反向列表

>>> 987654321
```

#### 字符串操作符

- 字符串的拼接 `str1+ str2`
- 字符串的成倍复制 `str * n` 或 `n * str`
- 成员运算 `子集 in 全集` 任何一个连续的切片都是原字符串的子集

```python
folk_singers = "Peter, Paul and Mary"    
"Peter" in folk_singers
>>> True
```

- 字符串的长度 `len(str)`

#### 字符编码

**将中文字库，英文字母、数字、特殊字符等转化成计算机可识别的二进制数**

- 每个单一字符对应一个唯一的互不重复的二进制编码
- Python 中使用的是 Unicode 编码

```python
# 将字符转化为 Unicode 码：ord（字符）
print(ord("1")) # 49
print(ord("a")) # 97
print(ord("*")) # 42
print(ord("中")) # 20013
print(ord("国")) # 22269

# 将 Unicode 码转化为字符：chr(Unicode 码）
print(chr(1010)) # ϲ
print(chr(10000)) # ✐
print(chr(12345)) # 〹
print(chr(23456)) # 宠
```

#### 字符串的分割：`str.split（分割字符）`

- 返回一个列表
- 原字符串不变

```python
languages = "Python C C++ Java PHP R"
languages_list = languages.split(" ")
print(languages_list)
print(languages)

>>> ['Python', 'C', 'C++', 'Java', 'PHP', 'R']
>>> Python C C++ Java PHP R
```

#### 字符串的聚合：`“聚合字符”.join（可迭代数据类型）`

```python
s = "12345"
s_join = ",".join(s)
s_join
```

- 序列类型的元素必须是字符类型

```python
s = ["1", "2", "3", "4", "5"]
"*".join(s) 
>>> '1*2*3*4*5'

s = [1, 2, 3, 4, 5]
"*".join(s) 
>>> TypeError: sequence item 0: expected str instance, int found
```

#### 删除两端特定字符：`str.strip（删除字符）`

- strip 从两侧开始搜索，遇到指定字符执行删除，遇到非指定字符，搜索停止
- 类似的还有左删除 lstrip 和右删除 rstrip
- 原字符串保持不变

```python
s = "      I have many blanks     "
print(s.strip(" "))
print(s.lstrip(" "))
print(s.rstrip(" "))
print(s)

>>> I have many blanks
>>> I have many blanks     
>>>       I have many blanks
>>>       I have many blanks     
```

#### 字符串的替换：`str.replace("被替换"，"替换成")`

- 原字符串不变

```python
s = "Python is coming"
s1 = s.replace("Python","Py")
print(s1)

>>> Py is coming
```

#### 字符串统计：`str.count("待统计字符串")`

```python
s = "Python is an excellent language"
print("an:", s.count("an"))
print("e:", s.count("e"))

>>> an: 2
>>> e: 4
```

#### 字符串字母大小写

- `str.upper()` 字母全部大写
- `str.lower()` 字母全部小写
- `str.title()` 首字母大写

### 布尔类型

```python
print(any([False,1,0,None]))   # 0 False None 都是无
>>> True
print(all([False,1,0,None]))
>>> False
```

#### 指示条件

```python
while True:
  if 语句：
    break
  else:
    语句
```

#### 作为掩码

```python
import numpy as np
x = np.array([[1, 3, 2, 5, 7]])   # 定义 numpy 数组
print(x > 3)
>>> [[False False False  True  True]]

x[x > 3]
>>> array([5, 7])
```

### 类型判别

- isinstance（变量，预判类型），**承认继承**
- 变量类型是预判类型的子类型，则为真，否则为假

#### 字符串检查

- `str.isdigit()` 字符是否只由数字组成
- `str.isalpha()` 字符是否只由字母组成
- `str.isalnum()` 字符是否只由数字和字母组成

### 类型转换

- 数字类型转字符串 `str（数字类型）`
- 仅由数字组成的字符串转数字 `int()`; `float()`; `eval()`

## 三、组合数据结构

### 列表

- 列表生成方式：`list（可迭代对象）`
- 可迭代对象包括：字符串、元组、集合、range() 等

```python
# 字符串转列表
list("人工智能是未来的趋势")
>>> ['人', '工', '智', '能', '是', '未', '来', '的', '趋', '势']

# 元组转列表
list(("人", "工", "智", "能"))
>>> ['人', '工', '智', '能']

# 集合转列表
list({"李雷", "韩梅梅", "Jim", "Green"})
>>> ['Green', 'Jim', '李雷', '韩梅梅']
```

`range（起始数字，中止数字，数字间隔）`

- 如果起始数字缺省，默认为 0
- 必须包含中止数字
- 数字间隔缺省，默认为 1

```python
# range() 转列表
list(range(1, 11, 2))
>>> [1, 3, 5, 7, 9]
```

- 列表生成式 `[x for x in range()`

```python
[x * x for x in range(1, 11)]
>>> [1, 4, 9, 16, 25, 36, 49, 64, 81, 100]

[x * x for x in range(1, 11) if x % 2 == 0] # for 循环后面还可以加上 if 判断，筛选出仅偶数的平方
[4, 16, 36, 64, 100]

[m + n for m in 'ABC' for n in 'XYZ'] # 使用两层循环生成全排列
>>> ['AX', 'AY', 'AZ', 'BX', 'BY', 'BZ', 'CX', 'CY', 'CZ']

d = {'x': 'A', 'y': 'B', 'z': 'C' } # 列表生成式也可以使用两个变量来生成 list
[k + '=' + v for k, v in d.items()]
>>> ['y=B', 'x=A', 'z=C']
```

- 列表生成式的 if else

```python
[x for x in range(1, 11) if x % 2 == 0 else 0]
>>> File "<stdin>", line 1 SyntaxError: invalid syntax
```

因为跟在 for 后面的 if 是一个筛选条件，不能带 else，否则无法筛选。

```python
[x if x % 2 == 0 else -x for x in range(1, 11)]
>>> [-1, 2, -3, 4, -5, 6, -7, 8, -9, 10]
```

把 if 写在 for 前面必须加 else，否则报错。因为 for 前面的部分是一个表达式，它必须根据 x 计算出一个结果。因此，考察表达式：x if x % 2 == 0，它无法根据 x 计算出结果，因为缺少 else，必须加上 else。

### 列表的操作方法

#### 1. 增加元素

- 在末尾增加元素：`list.append（待增元素）`
- 在任意位置插入元素：`list.insert（位置编号，待增元素） `
- 在末尾整体并入另一列表：`list1.extend(list2)`
  - append 将列表 2 整体作为一个元素添加到列表 1 中

#### 2. 删除元素

- 删除列表 i 位置的元素：`list.pop（位置）`
  - 不写位置信息，默认删除最后一个元素
- 删除列表中的第一次出现的待删元素：`list.remove（待删元素）`

```python
languages = ['Python', 'C', 'R', 'C', 'Java']
languages.remove("C")  

>>> ['Python', 'R', 'C', 'Java']
```

#### 3. 查找元素

- 列表中第一次出现待查元素的位置：`list.index（待查元素）`

```python
languages = ['Python', 'C', 'R','Java']
idx = languages.index("R") 

>>> 2
```

#### 4. 修改元素

- 通过"先索引后赋值"的方式，对元素进行修改 `list[位置]=value`

#### 5. 列表的复制

- 错误的方式：直接复制，两者地址相同，一个改变另一个也会改变

```python
languages = ['Python', 'C', 'R','Java']
languages_2 = languages

languages.pop()
print(languages)
print(languages_2)

>>> ['Python', 'C', 'R']
```

- 正确的方式：浅拷贝

```python
languages = ['Python', 'C', 'R','Java']
languages_2 = languages.copy()
```

- 正确的方式：列表切片

```python
languages = ['Python', 'C', 'R','Java']
languages_3 = languages[:]
```

#### 6. 列表的排序

- 使用`list.sort() 对列表进行永久排序  `ls.sort()``
- 直接在列表上进行操作，无返回值
- 递减排列 `ls.sort(reverse = True)`

临时排序

- 使用 sorted（列表）对列表进行临时排序
- 原列表保持不变，返回排序后的列表

```python
ls = [2, 5, 2, 8, 19, 3, 7]
ls_2 = sorted(ls)
ls_3 = sorted(ls, reverse = True)
```

#### 7. 列表的翻转

- 使用`list.reverse()` 对列表进行永久翻转
- 直接在列表上进行操作，无返回值

#### 8. 下标循环

- `enumerate()` 函数可以把一个 list 变成索引-元素对

```python
for i, value in enumerate(['A', 'B', 'C']):
  print(i, value)

0 A
1 B
2 C
```

### 元组

- 元组是一个可以使用多种类型元素，一旦定义，内部元素不支持增、删和修改操作的序列类型
- 通俗的讲，可以将元组视作“不可变的列表”
- 不支持元素增加、元素删除、元素修改操作，其他操作与列表的操作完全一致

#### 元组的常见用处

- 打包与解包

```python
numbers = [201901, 201902, 201903]
name = ["小明", "小红", "小强"]
list(zip(numbers,name)) # 打包
>>> [(201901, '小明'), (201902, '小红'), (201903, '小强')]

dict(zip(numbers,name))
>>> {201901: '小明', 201902: '小红', 201903: '小强'}

for number,name in zip(numbers,name):   # 每次取到一个元组，立刻进行解包赋值
    print(number, name)

>>> 201901 小明
>>> 201902 小红
>>> 201903 小强
```

### 字典

- 映射类型： 通过“键”-“值”的映射实现数据存储和查找
- 常规的字典是无序的

字典键的要求

- 字典的键不能重复（相同的键前面的会被覆盖）
- 字典的键必须是不可变类型，如果键可变，就找不到对应存储的值了
  - 不可变类型：数字、字符串、元组。一旦确定，它自己就是它自己，变了就不是它了。
  - 可变类型：列表、字典、集合。一旦确定，还可以随意增删改。

#### 字典的性质

- 字典的长度 `len(dict)`
- 字典的索引 `dict[key]`

### 字典的操作方法

#### 1. 增加键值对

- `dict[新键] = 新值`
- `dict.update(dict2)` 将字典 dict2 的键/值对更新到 dict 里。

#### 2. 删除键值对

- `del dict[key]`
- `dict.pop(key)` 返回删除键值对的值
- `dict.popitem()` 随机删除一个键值对，并以元组返回删除键值对

#### 3. 修改值

- 通过先索引后赋值的方式对相应的值进行修改 `dict[key]=newvalue`

#### 4. 取键值

- `dict.get(key,default)` 从字典 d 中获取键 key 对应的值，如果没有这个键，则返回 default

```python
s = "牛奶奶找刘奶奶买牛奶"
d = {}
print(d)
for i in s:
    d[i] = d.get(i, 0)+1

>>> {'牛': 2, '奶': 5, '找': 1, '刘': 1, '买': 1}
```

- `dict.keys()` `dict.values()` 分别取字典的键、值

```python
students = {201901: '小明', 201902: '小红', 201903: '小强'}
print(students.keys())
print(students.values())

>>> [201901, 201902, 201903]
>>> ['小明', '小红', '小强']
```

- `dict.items()` 方法及字典的遍历

```python
print(list(students.items()))
for k, v in students.items():
    print(k, v)

>>> [(201901, '小明'), (201902, '小红'), (201903, '小强')]
201901 小明
201902 小红
201903 小强
```

### 集合

- 一系列互不相等元素的无序集合
- 元素必须是不可变类型：数字，字符串或元组，可视作字典的键
- 可以看做是没有值，或者值为 None 的字典

集合的运算

- 交集 `set1 & set2`
- 并集 `set1 | set2`
- 集合 1 和 2 中的非共同元素 `set1 ^ set2` 
- 集合 1 但不在集合 2 中的元素 `set1 - set2`

### 集合的操作方法

- 增加元素 `set.add(x)`
- 移除元素 `set.remove(x)`
- 集合的长度 `len(set)`
- 集合的遍历 借助 for 循环

## 四、控制语句

### if 语句

#### 条件测试

- 比较运算 `> < == !=` 非空
- 逻辑运算 `and or not`
  - 复合逻辑运算的优先级：非 > 与 > 或
- 存在运算 `元素 in/not in 列表/字符串`

#### 分支结构

- 单分支
- 二分支
- 多分支 `if: elif: elif: ... else:`
- 嵌套语句

### 遍历循环 for 循环

- **for** 元素 **in** 可迭代对象：执行语句
- 从可迭代对象中，依次取出每一个元素，并进行相应的操作

可迭代对象

- 直接迭代：列表 [ ]、元组 ( )、集合{ }、字符串" "
- 变换迭代：字典 `for k,v in dict.item():`
- range() 对象

#### 循环控制：break 和 continue

- break 结束整个循环
- continue 结束本次循环
- for 与 else 的配合：如果 for 循环全部执行完毕，没有被 break 中止，则运行 else 块

### while 循环

- 代码可能需要重复执行，可是又不知道具体要执行多少次

#### 风向标

```python
flag = True     # 布尔类型
while flag:
  if 语句：
    flag = False # 退出循环
```

```python
flag=True  
while flag:  
    pass  
    while flag:  
        pass  
        while flag:     
            flag = False     # 循环逐层判断，当 flag 为 false 时，循环会逐层退出
```

- break 结束整个循环
- continue 结束本次循环
- for 与 else 的配合：如果 for 循环全部执行完毕，没有被 break 中止，则运行 else 块

### 控制语句注意问题

- 尽可能减少多层嵌套
- 避免死循环
- 封装过于复杂的判断条件

如果条件判断里的表达式过于复杂，出现了太多的 not/and/or 等，考虑将条件封装为函数
