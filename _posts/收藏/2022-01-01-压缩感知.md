---
title: "压缩感知"
subtitle: "压缩感知相关知识"
layout: post
author: "L Hondong"
header-img: "img/post-bg-14.jpg"
tags:
  - 压缩感知
---

# 压缩感知（Compressed Sensing）

[压缩感知 (Compressed Sensing)](https://en.wikipedia.org/wiki/Compressed_sensing)，曾经在 2008 - 2013 那段时间大红大紫，在信号处理，信息论，通信，甚至计算机视觉领域的热度，直逼如今的 Deep Learning，几乎称霸了各大信号处理会议和期刊。

这波热潮的真正开端是在 06-07 年，Terence Tao，Candès，Donoho 几个人提出的基于 sparsity prior 的 compressed sensing 框架，这套 compressed sensing 框架和配套理论证明了，在采样率低于 critical sampling rate 的时候，本来 ill-posed 的信号恢复和重建问题，可以在通过额外的 sparisty prior 的帮助下，达到巧妙的信号完美恢复。不仅如此，Tao 他们还推导了 [Restricted Isotropic Property (RIP)](https://en.wikipedia.org/wiki/Restricted_isometry_property) 等一系列理论，证明了为了达到完美恢复，采样矩阵和信号稀疏度需要满足的条件和相互之间的关系。这为之后 Compressed Sensing 的发展和应用奠定了理论基础。

这一套 Compressed Sensing 的体系缔造了上一个信号处理的春天，大量的项目和学者投入研究，相关的工作无数，实在没法在这么短篇幅里全部总结。这里只用一些简单的例子，科普以下 Compressed Sensing 的基本概念，讲解一些应用，以及澄清几个常见的误区。

## 一、什么是压缩感知？

压缩感知，常见的对应英文词汇包括 compressed sensing，compressive sensing, compressive sampling 等等，其实都是一个意思。在这里我们一律简称为 **CS**。

要理解 CS，要从 sensing 和 compressed 两个词入手。

### 1. 什么是感知（sensing）?

Sensing 描述的是，为了表达和恢复某一个信号或者对象，对其采取某种感知手段（这里的感知包括了对图像的 imaging，对连续信号的 sampling 等等），从而得到这种感知模态下的 measurement，以便之后的信号重建以及分析等应用，这样一个过程。

拿图像重建举一个例子：如果要感知一个 10x10 像素的图像，最简单最直接的方式，就是直接在空间域里面感知，得到并储存图像的 100 个像素点，这样的话，可以通过把这 100 个像素点排列为矩阵的方式，重建这副目标图像。这里获取这 100 个点的过程，就称之为 sensing。

### 2. 什么是压缩（compressed）？

在上面的例子中，我们感知了一个 10x10 图像全部的 100 个像素点，一般称这种 sensing 叫做**全采样（full sampling）**，因为目标信号是一个 100 维的信号，而你也获得了对应的 100 维 measurement，可以很直接地完美恢复图像。这样的感知方式没有任何的压缩，i.e., **感知到的维度=信号本身的维度**。当然你也可以采集更高维度的 measurement，称之为 over-sampling/over-sensing， 但多余的采样并不会进一步提高图像恢复（信号已经达到完美恢复了）。

在不借助信号先验的前提下，我们把需要的最少的感知样本维度（这里是 100），记做是 **critical sampling rate**。那么你也可以选择感知少于 critical rate 的 measurement，比如你只采集 98 个点，这种情况我们称之为是  **under-sampling**，这样就起到了对 full sensing 的压缩，也就是 compressed 了。

### 3. CS 要解决什么问题？

CS 要解决的是，**如何在 under-sampling 的情况下，依然可以完美地恢复目标图像**。

经典的信号处理体系是建立在经典的线性代数和统计的基础上的，那么处理这类 under-sampling 的重建问题，类似于需要解 100 个未知数，却只有 98 个线性方程组。

按照经典信号处理的理论，这类问题是存在无穷多解的（无法唯一确定地完美恢复目标图像）。我们把这类问题成为病态问题（**ill-posed problem**），而 compressed sensing 就是用来解决 ill-posed 的 inverse problems（逆问题）。

不同于给的例子中，感知是直接在空间域进行 under-sampling，所谓 **compressed sensing**，其实就是一种**更加 smart 的 under-sampling 的感知，并且在借助有效的信号先验的帮助下，追求达到对图像的完美重建**。

但是为什么 Compressed Sensing 可以做到这一点呢？听上去很神奇，但这里主要的额外帮助来自于信号的先验。咱们还是用之前分析的恢复 10x10 图像的例子：

在不借助信号先验的条件下，通过 98 个线性方程组，解 100 个未知数，理论上的解空间的自由度会有一个二维平面那么大，而这平面上的每个点都可以是我们恢复的图像，没有唯一解。但如果引入了一个**信号固有的先验**：比如真实的图像的解只能在某条线上。这就相当于我们在 98 个线性方程上，外加了一个 **linear constraint**。这个 line 和我们的解空间自由的平面的交点，就唯一确定了一个解：这个解既满足 98 个线性方程组，又在我们的 linear constraint 上。这个例子其实就解了一个极其简化的 compressed sensing 问题。

## 二、狭义 vs 广义的 Compressed Sensing

我们经常讨论的 compressed sensing (CS)，在方法层面上，有狭义和广义两种概念下的定义：

### 1. 狭义的 CS

狭义的 CS，是完全 follow 之前 Tao 他们在 06-07 提出的框架以及理论证明，只利用信号的稀疏性 (sparsity）作为先验，帮助信号恢复。狭义的 CS 有比较完备的理论研究：比如如何设计 Sensing 的模态和方式，使得恢复信号质量最高 (i.e., error 最小）。

在这套理论下，要求采样矩阵和稀疏字典的 coherence 尽量要小，从而在给定某个 sampling rate 和 sparsity 的条件下，达到最佳的图像恢复。因为先验是 sparsity，随机的 sampling matrix 成为了一个不错的 sensing 系统选择。

但值得提出的是，random sampling 也不见得是绝对意义上的最佳的 sensing matrix。只不过用 random sampling matrix，可以证明他和 transform domain 下的 sparsity constraint，有比较小的 coherence。在实际应用中，满足 sparsity 的信号，其实是在 **a union of low-dimensional subspaces** 里面的。在不确定 non-zero 的 support 的情况下，分析 sensing matrix 和 general case 下的 sparsity constraint 之间的 coherence 其实并不容易。所以用 random sampling 是个不错的选择。

### 2. 广义的 CS

广义的 CS，可以使用一切有效且可以利用的信号先验，帮助信号重建以及解决 ill-posed inverse problems。实际上除了信号的可稀疏性以后，还有很多被证明有用的信号模型：包括 low-rank model, statistical model, non-local mean，甚至包括深度先验 (deep prior），都可以用来帮助图像重建。除了稀疏先验以外的先验，不一定有在 CS 框架下的理论和重建保证。

在广义定义下，只要是通过 signal prior 建立 regularizer，构造一个优化问题解决 ill-posed problem，都可以算 compressed sensing。包括最新的一些利用 plug-and-play 拿 deep prior 做图像重建的问题。

随着 CS 应用的发展，越来越多的工作开始关注广义的 CS，并且研究除了 sparsity 以外，不同 prior 之间对重建的增益。这样的框架，可以把当下最火的 deep learning 也包括在内。

### 3. 在图像处理的环境下，哪些任务是基于 compressed sensing 框架？

Compressed sensing 在图像处理和计算成像领域，有很多应用。包括但不限于：

- **图像修复问题**: Image super-resolution, Interpolation, Inpainting, etc. (Image Denoising 不是 CS 问题）
- **计算成像问题**: low-dose CT, undersampled MRI, etc.
- **图像合成**: multi-channel measurement fusion, hyperspectral / multispectral fusion, etc.

图像修复问题里面，inpainting 应该是最好理解的：图像的一部分像素点缺失，恰好和我们在第一部分里面讨论的例子很像：在不借助外部先验的条件下，恢复缺损的像素点，本身是病态问题。换句话说，可以拿任何大小的像素点补全缺损的部分。但考虑到图像本身的性质和先验，就可以得到看起来最自然，也质量最高的 inpainting 结果。这个问题本质，其实就是在空间域里面的 compressed sensing 问题。

计算成像问题里面，医学成像是 compressed sensing 得到商业应用的一个很重要部分。比如前段时间西门子的，基于 compressed sensing 的一台 MRI 扫描仪就获得了美国 FDA 的许可，开始应用于临床。总体来说，医学成像对 compressed sensing 感兴趣，主要是（但不限于）为了解决 (1) 发射过大 和 (2) 扫描过慢 这两个问题。比如 CT 就是一种带放射性的成像方式，相比于扫一般物体，可以无节制地增大扫描精度，扫人体必须要对放射量（dose）有限制。但如果不使用 compressed sensing 的技术，得到的可能就是非常低质量或者有 artifacts 的图像。再比如 MRI ，本身是一个没有放射性的成像方式，但最大的问题是，经典 MRI 扫描人体可能会非常慢，这会对病人造成不舒适。Compressed Sensing 可以实现在降采样（更快）的前提下，依然保证成像的质量。

图像合成里面，可以认为多通道的采样，都是针对同一个目标的降采样。同样的，可以利用一个目标图像的固有属性，i.e., 信号先验，来帮助融合以及重建信号。相较于 single channel 的 sensing 问题，这类更加复杂的 compressed sensing 挑战，需要关注的不光是开发信号本身的先验，还有如何利用 cross-channel correlation，使得不同的 sensing matrix 之间的关系得到最大化的利用。

### 4. 一些常见的误区：

#### Compressed Sensing 这类型的概念，最早是 Tao 他们提出的。

这个其实是不准确的：利用信号先验，包括 sparsity 等等，来解决病态逆问题，这类框架和概念其实早在 80/90 年代就已经被信号处理领域研究，只不过没有叫 Compressed Sensing 这个名字而已。但可惜的是之前的研究很多并没有提供配套理论以及分析采样和先验的数学关系。所以 Tao 他们搞的 CS 体系，真正的贡献以及突破，是提供了比较完备的理论支持和保证，从而真正说服大家，并且带动了高热度的科研投入。

#### Compressed Sensing 只能用 random sampling，并且**只能用 sparsity prior**。

在正文里面，我已经澄清了：

1. random sampling 在用 sparsity prior 的信号重建问题里，是个不错的 sensing system，因为他和 sparsity prior 有较小的 coherence。但并不是说 random sampling 就是绝对意义上的最佳选择。
2. 在广义的 CS 下，sparsity 并不是唯一可用的 signal prior。如果要回归到 Tao 他们的经典 CS 框架下，确实大量的理论证明，只讨论了 sparsity 作为 prior 的情况。但这并不能局限其他 prior 被应用到 compressed sensing 的应用中去。

#### Compressed Sensing 已经**过时和完蛋**了。

我记得前年的 ICASSP，专门有一个 Panel discussion 在讨论 “Is compressed sensing dead?”

我的看法是：狭义的 compressed sensing 似乎已经有了比较完备的理论体系，并且有足够多的实践了。但这并不证明这套 compressed sensing 的框架已经过时了。事实上，广义的 compressed sensing 正在被应用到各种有趣的实际问题中，而且如今机器学习的热潮，带动了利用数据驱动的方式主动学习信号先验的可能性。我的很多研究也在关注这一块儿，并且我认为，compressed sensing never dies, it just becomes more flexible。比如我博士期间的论文，主要就是关注 blind compressed sensing，也就是认为 signal prior 不再是事先可知（blind），而是通过数据驱动的方式去获取。这样的先验可以对于你将要处理的数据最优化，从而达到更加好的信号重建。

所以，相较于悲观和担忧，做信号处理和 compressed sensing 的学者，更应该思考的是，如何不再固步自封，而去拥抱最新的技术，使得经典的 sensing 框架更加灵活。