---
title: "VScode 下的 Vim 快捷键"
subtitle: ""
layout: post
author: "L Hondong"
header-img: "img/post-bg-46.jpg"
tags:
  - Vim
  - VSCode
---

# VIM 入门

## 模式切换

在 VSCode 中打开文件时，文件默认状态为 vim 下的 **Normal** 模式，输入`i`，从 **Normal** 模式切换至 **Insert** 模式，此时就可以正常输入文本了，`ESC`可以返回 **Normal** 模式。

| 命令（按键） | 作用 |
| --- | --- |
| i          | 进入 Insert 模式 |
| ESC        | 退回 Normal 模式 |
| :w | 将编辑的数据写入硬盘文件中(常用) |
| :w! | 若文件属性为只读时，强制写入该文件，与权限有关|
| :q | 离开 |
| :q!	| 若曾修改过文件，又不想储存，使用 ! 强制离开不储存文件 |
| :wq	| 储存后离开，若为 :wq! 则为强制储存后离开 (常用)|
| ZZ | 如果修改过，保存当前文件，然后退出。效果等同于(保存并退出) |
| ZQ | 不保存，强制退出。效果等同于 :q! |
| :w [filename] | 将编辑的数据储存成另一个文件（类似另存新文件）|
| :r [filename] |	在编辑的数据中，读入另一个文件的数据。亦即将 filename 这个文件内容加到游标所在行后面 |
| :n1,n2 w [filename] |	将 n1 到 n2 的内容储存成 filename 这个文件 |
| :! command | 暂时离开 vi 到指令行模式下执行 command 的显示结果！例如 `:! ls /home` 即可在 vi 当中察看 /home 底下以 ls 输出的文件信息 |

## Vim 定位命令

### 光标上下左右

| 命令 | 作用 | 模式 |
| --- | --- | --- |
| h | 光标向左移动一格 | Normal |
| l | 光标向右移动一格 | Normal |
| j | 光标向下移动一行 | Normal |
| k | 光标向上移动一行 | Normal |
| 上下左右键 | 上下左右切换光标 | Insert & Normal |
| Ctrl + f | 屏幕向下移动一页，相当于 [Page Down]按键 |
| Ctrl + b | 屏幕向上移动一页，相当于 [Page up]按键 |
| Ctrl + d | 屏幕向下移动半页 |
| Ctrl + u | 屏幕向下移动半页 |


### 行内光标定位

| 命令 | 作用 | 模式 |
| --- | --- | --- |
| 0    | 到当前行的开头 | Normal |
| home | 到当前行的开头 | Normal & Insert |
| ^    | 到当前行第一个不是 blank 字符的位置   | Normal |
| $    | 到当前行的末尾 | Normal  |
| g_   | 到当前行最后一个不是 blank 字符的位置 | Normal |
| gg   | 到第一行 | Normal |
| nG   | n 为行编号，到第 n 行 | Normal |
| G    | 到最后一行 | Normal  |

**注：blank 字符是指空格，tab，换行，回车等**。

### 词汇定位

#### 1. 默认方式，一个单词由字母，数字和下划线组成

| 命令 | 作用 | 模式 |
| ---- | --- | ----- |
| w | w（小写），到下一个单词的开头 | Normal |
| e | e（小写），到下一个单词的结尾 | Normal |

#### 2. 如果单词以 blank 分隔，使用大写的 W 和 E 分隔

#### 3. 单词匹配

| 命令 | 作用 | 模式 |
| --- | --- | --- |
| * | 移动到与当前光标匹配的下一个单词 | Normal |
| # | 移动到与当前光标匹配的上一个单词 | Normal |

**注：可以用来搜索变量**。

### 括号匹配

| 命令 | 作用 | 模式 |
| --- | --- | --- |
| % | 定位与光标所在括号相对应的另一半 | Normal |

## Vim 编辑命令

### Vim 插入

Vim 插入命令，光标定位完成后，进行插入操作前的命令，命令执行之后切换至`Insert`模式：

| 命令 | 作用 | 模式 |
| --- | --- | --- |
| a | 在光标后插入，光标定位后输入 i 命令默认是光标插入前插入的 | Normal |
| A | 从光标所在行的最后一个字符处开始输入 | Normal |
| o | 在当前行之后插入新的一行，相当于回车效果 | Noraml |
| O | 在当前行之前插入新的一行 | Normal |

### Vim 查找

Vim 是通过正则匹配来实现的，在`Noramal`模式下，先输入`/`，进入搜索模式。输入想要搜索的词汇，此时在 VSCode 中会高亮所有的匹配项，单击 Enter 之后，单击`n`查找下一个，单击`N`查找下一个。

### Vim 替换

语法：`Vim`的替换语法为：`:[addr]s/待替换字符/替换字符 [option]`

#### :（英文冒号）

表示替换命令开始

#### [addr] 检索范围

- .（小数点）表示当前行
- $：表示文件最后一行
- %：表示整个当前文件
- n（行号）：表示第 n 行
- n1,n2: 表示从第 n1 行到第 n2 行
- n,$: 表示第 n 行到文档最后一行
- ., $: 表示 当前行到文档最后一行
- ., n: 表示当前行到文档第 n 行

#### s 替换操作

字母 s 表示替换操作

#### [option] 操作类型

- g: 表示全局替换， 在检索范围内替换所有匹配项
- c: 表示确认替换， 在替换时需要 输入 y 一一确认
- p: 表示显示替代结果， 按 enter 后执行替换
- option 省略时仅对每行第一个匹配字符串进行替换

#### 例子

- `.s/from/to/ `将当前行中的第一个 from，替换成 to。如果当前行有多个 from，则只会替换其中的第一个
- `:%s/from/to/g` 将文档中所有的 from 替换成 to
- `:1,5s/from/to/c `将文档的第 1 到第 5 行，每行的第一个 from 替换成 to, 并需要确认
- `:6,$s/from/to/gc `从第 6 行开始至最后一行，将所有的 from 换从成 to, 并需要确认
- `:.,7s/from/to/p `从当前行到第 7 行，将每行地一个 from 替换成 to, 替换前显示替换结果，按回车后生效

### Vim 拷贝、粘贴、删除

#### 拷贝

| 命令 | 作用 | Normal |
| --- | --- | --- |
| y | 拷贝当前行以及其后一行，共两行 | Normal |
| yy | 拷贝当前行 | Normal |
| nyy | n 为大于 1 的数字，拷贝 n 行，第一行为光标所在行 | Normal |
| ye | 从光标位置开始拷贝，至遇到第一个空后结束（不包括空格） | Normal |
| yw | 从光标位置开始拷贝，至遇到第一个空格后结束（包括空格） | Normal |
| y$ | 从光标位置开始拷贝，到当前行行尾，包括空格 | Normal |
| y0 | 从光标位置开始拷贝，到当前行行首，包括空格 | Normal |
| ynl | 从光标位置开始，向右拷贝 n 个字符 | Normal |
| ynB | 从光标位置开始，向左拷贝 n 个单词 | Normal |

#### 粘贴

| 命令 | 作用 | 模式 |
| --- | --- | --- |
| p | 小写 p，在光标之后插入拷贝 | Normal |
| P | 大写 P，在光标之前插入拷贝 | Normal |
| np(nP) | 重复复制 n 次 | Normal |

##### 如何拷贝某一块区域，比较精确的选择拷贝区域？

1. 在 Normal 模式下，将光标定位至目标拷贝区域的开始或结束位置，输入命令 `v`（小写）进入视图模式。
2. 移动光标，光标所经过的位置都被选中，（跟鼠标选中形式一样）。
3. 区域选定结束后， 输入 `y `命令，复制成功。
4. 如果输入大写 `V `命令，此时只能以行为单位选中区域。

##### 如何实现跨文件拷贝/粘贴？

- 在文件 A 复制的内容在文件 B 中使用，使用命令 +y, 即将复制的内容添加到系统的剪切板，供其他程序使用 （这个命令在 debian 下不好用，只在全选复制的情况下有用，复制部分的话使用右键复制，)
- 使用命令 +p, 可以将系统剪切板中的内容，粘贴到当前文件 （这个命令不好用）
- 在 Insert 模式下 (VSCode 中 Normal 模式也可以）， 使用快捷键 shift+insert 可以将系统剪切板中的内容，粘贴到当前文件，（推荐使用）

#### 删除

| 命令 | 作用 | 模式 |
| --- | --- | --- |
| x | 向后删除一个字符 | Normal |
| X |	向前删除一个字符 | Normal |
| nx | 连续向后删除 n 个字符 | Normal | 
| dd | 剪切当前行 | Normal |
| ndd | 剪切 n 行， 当前行为第一行 | Normal |
| dw | 从光标位置开始剪切， 至遇到第一个空后结束（包括空格）   | Normal |
| de | 从光标位置开始剪切， 至遇到第一个空后结束（不包括空格） | Normal |
| d$ | 从光标开始位置剪切， 至当前行行末， 包括空格 | Normal |
| d0 | 从光标开始位置剪切， 至当前行行首， 包括空格 | Normal |
| dl | 删除光标所在字符 | Normal |
| dh | 删除光标所在位置之前字符 | Normal |
| dnl | 从光标位置开始，向右剪切 n 个字符 | Normal |
| dnh | 剪切光标之前的 n 个字符（不包括光标所在字符）| Normal |
| dH | 剪切当前光标之前所有内容 | Normal |
| dL | 剪切当前光标之后所有内容（包括光标所在字符） | Normal |

##### 如何删除一块区域， 比较精确地删除区域？ 

- 同上文的拷贝一样， 只需把 **拷贝命令 y** 换成 **删除命令 d** 即可

## 撤销/取消撤销修

| 命令 | 作用 | 模式 |
| --- | --- | --- |
| u | 撤销上步修改 | Normal |
| ctrl+r | 恢复被撤销的修改 | Normal |

## 补充

1. 重复之前的命令 Normal 模式下输入 .（小数点）, n. 重复之前命令 n 次
2. 对括号内内容操作 （将光标定位至左括号）
   - ci’、ci”、ci(、ci[、ci{、ci< 分别更改这些配对标点符号中的文本内容
   -  di’、di”、di（或 dib、di[、di{或 diB、di< 分别删除这些配对标点符号中的文本内容
   - yi’、yi”、yi(、yi[、yi{、yi< 分别复制这些配对标点符号中的文本内容
   - vi’、vi”、vi(、vi[、vi{、vi< 分别选中这些配对标点符号中的文本内容
3. 全选（复制/删除）
   - Normal 模式下， 首先全选文档： ggVG => (gg 让光标移动到首行，v/V 进入 Vision 模式， G 移动到最后一行）
   输入 d 删除选中内容， 输入 y 复制选中内
4. 代码缩进
   Normal 模式下， 进入 Vision 模式，选中目标代码块，
   快捷键 shift+> 向右缩进
   快捷键 shift+< 向左缩进

VSCode 中，推荐关闭 Vim 扩展里的 useCtrlKeys，在 setting.json 中添加配置"vim.useCtrlKeys":false。